<!DOCTYPE HTML>
<html lang="zh-CN">


<head>
    <meta charset="utf-8">
    <meta name="keywords" content="游戏编程算法和技巧·网络游戏, 游戏，编程，生活">
    <meta name="description" content="一、协议想像寄真实的邮件。我们至少需要一个信封，上面写着这封邮件的寄信地址和手信地址。在信封里面放着的才是你真正需要传递的信息——邮件本身。数据包可以想象成是在网络上传输的电子信封。在它的数据头中有地址和其他相关信息，然后才发出真正的数据帧">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <meta name="renderer" content="webkit|ie-stand|ie-comp">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="format-detection" content="telephone=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <title>游戏编程算法和技巧·网络游戏 | GameOrLife</title>
    <link rel="icon" type="image/png" href="/favicon.png">

    <link rel="stylesheet" type="text/css" href="/libs/awesome/css/all.css">
    <link rel="stylesheet" type="text/css" href="/libs/materialize/materialize.min.css">
    <link rel="stylesheet" type="text/css" href="/libs/aos/aos.css">
    <link rel="stylesheet" type="text/css" href="/libs/animate/animate.min.css">
    <link rel="stylesheet" type="text/css" href="/libs/lightGallery/css/lightgallery.min.css">
    <link rel="stylesheet" type="text/css" href="/css/matery.css">
    <link rel="stylesheet" type="text/css" href="/css/my.css">
    
    <script src="/libs/jquery/jquery.min.js"></script>
    
<meta name="generator" content="Hexo 4.2.0"><link rel="stylesheet" href="/css/prism-tomorrow.css" type="text/css"><link rel="alternate" href="/atom.xml" title="GameOrLife" type="application/atom+xml">
</head>


<body>
    <header class="navbar-fixed">
    <nav id="headNav" class="bg-color nav-transparent">
        <div id="navContainer" class="nav-wrapper head-container">
            <div class="brand-logo">
                <a href="/" class="waves-effect waves-light">
                    
                    <img src="/medias/logo.png" class="logo-img" alt="LOGO">
                    
                    <span class="logo-span">GameOrLife</span>
                </a>
            </div>
            

<a href="#" data-target="mobile-nav" class="sidenav-trigger button-collapse"><i class="fas fa-bars"></i></a>
<ul class="right nav-menu">
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/" class="waves-effect waves-light">
      
      <i class="fas fa-home" style="zoom: 0.6;"></i>
      
      <span>首页</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/tags" class="waves-effect waves-light">
      
      <i class="fas fa-tags" style="zoom: 0.6;"></i>
      
      <span>标签</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/categories" class="waves-effect waves-light">
      
      <i class="fas fa-bookmark" style="zoom: 0.6;"></i>
      
      <span>分类</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/archives" class="waves-effect waves-light">
      
      <i class="fas fa-archive" style="zoom: 0.6;"></i>
      
      <span>归档</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/about" class="waves-effect waves-light">
      
      <i class="fas fa-user-circle" style="zoom: 0.6;"></i>
      
      <span>关于</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/contact" class="waves-effect waves-light">
      
      <i class="fas fa-comments" style="zoom: 0.6;"></i>
      
      <span>留言板</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/friends" class="waves-effect waves-light">
      
      <i class="fas fa-address-book" style="zoom: 0.6;"></i>
      
      <span>友情链接</span>
    </a>
    
  </li>
  
  <li>
    <a href="#searchModal" class="modal-trigger waves-effect waves-light">
      <i id="searchIcon" class="fas fa-search" title="搜索" style="zoom: 0.85;"></i>
    </a>
  </li>
</ul>

<div id="mobile-nav" class="side-nav sidenav">

    <div class="mobile-head bg-color">
        
        <img src="/medias/logo.png" class="logo-img circle responsive-img">
        
        <div class="logo-name">GameOrLife</div>
        <div class="logo-desc">
            
            Never really desperate, only the lost of the soul.
            
        </div>
    </div>

    

    <ul class="menu-list mobile-menu-list">
        
        <li class="m-nav-item">
	  
		<a href="/" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-home"></i>
			
			首页
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/tags" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-tags"></i>
			
			标签
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/categories" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-bookmark"></i>
			
			分类
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/archives" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-archive"></i>
			
			归档
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/about" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-user-circle"></i>
			
			关于
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/contact" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-comments"></i>
			
			Contact
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/friends" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-address-book"></i>
			
			友情链接
		</a>
          
        </li>
        
        
        <li><div class="divider"></div></li>
        <li>
            <a href="https://github.com/oliverbvb" class="waves-effect waves-light" target="_blank">
                <i class="fab fa-github-square fa-fw"></i>Fork Me
            </a>
        </li>
        
    </ul>
</div>

        </div>

        
            <style>
    .nav-transparent .github-corner {
        display: none !important;
    }

    .github-corner {
        position: absolute;
        z-index: 10;
        top: 0;
        right: 0;
        border: 0;
        transform: scale(1.1);
    }

    .github-corner svg {
        color: #0f9d58;
        fill: #fff;
        height: 64px;
        width: 64px;
    }

    .github-corner:hover .octo-arm {
        animation: a 0.56s ease-in-out;
    }

    .github-corner .octo-arm {
        animation: none;
    }

    @keyframes a {
        0%,
        to {
            transform: rotate(0);
        }
        20%,
        60% {
            transform: rotate(-25deg);
        }
        40%,
        80% {
            transform: rotate(10deg);
        }
    }
</style>

<a href="https://github.com/oliverbvb" class="github-corner tooltipped hide-on-med-and-down" target="_blank"
   data-tooltip="Fork Me" data-position="left" data-delay="50">
    <svg viewBox="0 0 250 250" aria-hidden="true">
        <path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path>
        <path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2"
              fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path>
        <path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z"
              fill="currentColor" class="octo-body"></path>
    </svg>
</a>
        
    </nav>

</header>

    



<div class="bg-cover pd-header post-cover" style="background-image: url('/medias/featureimages/16.jpg')">
    <div class="container" style="right: 0px;left: 0px;">
        <div class="row">
            <div class="col s12 m12 l12">
                <div class="brand">
                    <h1 class="description center-align post-title">游戏编程算法和技巧·网络游戏</h1>
                </div>
            </div>
        </div>
    </div>
</div>




<main class="post-container content">

    
    <link rel="stylesheet" href="/libs/tocbot/tocbot.css">
<style>
    #articleContent h1::before,
    #articleContent h2::before,
    #articleContent h3::before,
    #articleContent h4::before,
    #articleContent h5::before,
    #articleContent h6::before {
        display: block;
        content: " ";
        height: 100px;
        margin-top: -100px;
        visibility: hidden;
    }

    #articleContent :focus {
        outline: none;
    }

    .toc-fixed {
        position: fixed;
        top: 64px;
    }

    .toc-widget {
        width: 345px;
        padding-left: 20px;
    }

    .toc-widget .toc-title {
        margin: 35px 0 15px 0;
        padding-left: 17px;
        font-size: 1.5rem;
        font-weight: bold;
        line-height: 1.5rem;
    }

    .toc-widget ol {
        padding: 0;
        list-style: none;
    }

    #toc-content {
        height: calc(100vh - 250px);
        overflow: auto;
    }

    #toc-content ol {
        padding-left: 10px;
    }

    #toc-content ol li {
        padding-left: 10px;
    }

    #toc-content .toc-link:hover {
        color: #42b983;
        font-weight: 700;
        text-decoration: underline;
    }

    #toc-content .toc-link::before {
        background-color: transparent;
        max-height: 25px;
    }

    #toc-content .is-active-link {
        color: #42b983;
    }

    #toc-content .is-active-link::before {
        background-color: #42b983;
    }

    #floating-toc-btn {
        position: fixed;
        right: 15px;
        bottom: 76px;
        padding-top: 15px;
        margin-bottom: 0;
        z-index: 998;
    }

    #floating-toc-btn .btn-floating {
        width: 48px;
        height: 48px;
    }

    #floating-toc-btn .btn-floating i {
        line-height: 48px;
        font-size: 1.4rem;
    }
</style>
<div class="row">
    <div id="main-content" class="col s12 m12 l9">
        <!-- 文章内容详情 -->
<div id="artDetail">
    <div class="card">
        <div class="card-content article-info">
            <div class="row tag-cate">
                <div class="col s7">
                    
                    <div class="article-tag">
                        
                            <a href="/tags/%E6%B8%B8%E6%88%8F%E7%BC%96%E7%A8%8B/">
                                <span class="chip bg-color">游戏编程</span>
                            </a>
                        
                    </div>
                    
                </div>
                <div class="col s5 right-align">
                    
                    <div class="post-cate">
                        <i class="fas fa-bookmark fa-fw icon-category"></i>
                        
                            <a href="/categories/%E6%B8%B8%E6%88%8F%E7%BC%96%E7%A8%8B/" class="post-category">
                                游戏编程
                            </a>
                        
                    </div>
                    
                </div>
            </div>

            <div class="post-info">
                
                <div class="post-date info-break-policy">
                    <i class="far fa-calendar-minus fa-fw"></i>发布日期:&nbsp;&nbsp;
                    2020-05-08
                </div>
                

                
                <div class="post-date info-break-policy">
                    <i class="far fa-calendar-check fa-fw"></i>更新日期:&nbsp;&nbsp;
                    2020-05-08
                </div>
                

                
                <div class="info-break-policy">
                    <i class="far fa-file-word fa-fw"></i>文章字数:&nbsp;&nbsp;
                    5.7k
                </div>
                

                
                <div class="info-break-policy">
                    <i class="far fa-clock fa-fw"></i>阅读时长:&nbsp;&nbsp;
                    19 分
                </div>
                
				
                
                    <div id="busuanzi_container_page_pv" class="info-break-policy">
                        <i class="far fa-eye fa-fw"></i>阅读次数:&nbsp;&nbsp;
                        <span id="busuanzi_value_page_pv"></span>
                    </div>
				
            </div>
            
        </div>
        <hr class="clearfix">
        <div class="card-content article-card-content">
            <div id="articleContent">
                <h1 id="一、协议"><a href="#一、协议" class="headerlink" title="一、协议"></a>一、协议</h1><p>想像寄真实的邮件。我们至少需要一个信封，上面写着这封邮件的寄信地址和手信地址。在信封里面放着的才是你真正需要传递的信息——邮件本身。<strong>数据包</strong>可以想象成是在网络上传输的电子信封。在它的<strong>数据头</strong>中有地址和其他相关信息，然后才发出真正的<strong>数据帧</strong>。</p>
<p>对于信封来说，地址有较标准的格式。寄信地址在左上角，目的地址在右边中间，而邮票在右上角。这是大多数国家最常见的格式。但是对于网络数据传输，有着很多不同的<strong>协议</strong>或规则来定义数据包以什么格式以及为了发生必须做什么。网络游戏现在通常会让游戏逻辑使用两种协议之一:TCP、UDP。有的游戏会使用第三种协议，ICMP，常用于一些非游戏逻辑的功能。</p>
<h2 id="1-IP"><a href="#1-IP" class="headerlink" title="1.IP"></a>1.IP</h2><p>IP，全称Internet Protocol(国际网络协议)，要通过网络发送数据，这是需要遵守的最基本的协议。本章提到的每一个协议，不管是ICMP、TCP还是UDP，都必须附加IP协议才能够传输数据。哪怕数据只是在本地网络上传输。这就造就了一个事实，那就是现在所有在本地网络上的机器都需要有一个特定的本地地址，只有这样才能通过IP标识某个特定的本地机器。</p>
<p>IP的数据头有着大量的字段。</p>
<center>
    <img style="border-radius: 0.3125em;
    box-shadow: 0 2px 4px 0 rgba(34,36,38,.12),0 2px 10px 0 rgba(34,36,38,.08);" src="http://pw9tlh9pq.bkt.clouddn.com/1.png">
    <br>
    <div style="color:orange; border-bottom: 1px solid #d9d9d9;
    display: inline-block;
    color: #999;
    font-size: 12px;
    padding: 2px;">图 IPv4数据头的结构</div>
</center>

<p>有两个广泛使用的IP协议版本:IPv4和IPv6。IPv4地址是四个字节被分开用十进制写出，中间用点分隔。所以，举个例子，本地网络地址可能是192.168.1.1。由于IPv4地址是32位的，所以大概有40亿种可能组合，在1977年IPv4第一次出现时，这看起来是非常庞大的地址空间，但是到了今天，却有点不够用了。</p>
<p>为了解决这个问题，IPv6被开发了出来。它使用128位地址，所以支持惊人的$2^128$的地址空间。IPv6的一个缺点就是它们很难记忆，因为它们的完整形式是用冒号隔开的十六进制数，就像是2001:0db8:85a3:0042:1000:8a2e:0370:7334这样。</p>
<h2 id="2-ICMP"><a href="#2-ICMP" class="headerlink" title="2.ICMP"></a>2.ICMP</h2><p>ICMP，全称Internet Control Messaging Protocol(国际网络控制消息协议)，并不用于在网络上传输大量数据。因此，它不能用于发送游戏数据。但ICMP具有发送<strong>回声</strong>包的能力。通过ICMP，可以发送数据包给特定地址，然后直接让数据包返回给发送者，这是通过ICMP的回声请求和回声响应机制完成的。这个回声功能可以用于策测量两台计算机之间发包所需要的时间。</p>
<p>行程往返的时间，就是<strong>延迟</strong>，在玩家有多台服务器可以选择连接的时候特别有用。在游戏测量所有可以连接的服务器的延迟之后，就可以选择连接延迟最低的服务器。这个测量某个地址的延迟的过程称为ping。</p>
<p>当回声请求发送之后，接收者收到数据包接着以正确的回声包回传回去。由于ICMP数据头没有任何的时间戳信息，在发出回声请求之前，发送者需要自己决定当前的时间戳，然后记录到数据帧里面。当回声应答的数据帧返回之后，发送和接收的时间戳的差别就可以计算出来，这样就能得到往返时间。这个过程通常会重复很多次，这样就可以得到平均延迟。</p>
<center>
    <img style="border-radius: 0.3125em;
    box-shadow: 0 2px 4px 0 rgba(34,36,38,.12),0 2px 10px 0 rgba(34,36,38,.08);" src="http://pw9tlh9pq.bkt.clouddn.com/2.png">
    <br>
    <div style="color:orange; border-bottom: 1px solid #d9d9d9;
    display: inline-block;
    color: #999;
    font-size: 12px;
    padding: 2px;">图 ICMP回声请求数据包的结构</div>
</center>

<p>ICMP数据包中的校验和被用来确保数据包在传输的过程中不会有数据出错，校验和的值是用ICMP数据头和数据帧计算出来的。如果接收者收到ICMP数据包，但是校验和不正确，这个包会被拒绝。因为校验和是基于数据包中的所有其他数据计算得出的，所以在数据包传输之前一定要计算好。标识符和顺序号有回声请求指定——通常每台机器的标识符都不一样，而顺序号应该随着每次发送新的回声请求的时候递增。</p>
<h2 id="3-TCP"><a href="#3-TCP" class="headerlink" title="3.TCP"></a>3.TCP</h2><p><strong>传输控制协议</strong>(TCP)是游戏在网络上用来传输数据最常用的两个协议之一。TCP是一个基于连接的、可靠的、保证顺序的协议。</p>
<p>TCP是基于连接的，就是说两台计算机在任何数据传输之前，必须先建立好彼此的连接。连接完成的方法是通过握手。请求连接的计算机发送一个连接请求到目标计算机，告诉它自己想要如何连接，然后接收者确认这个请求，这个确认在被最初的请求者再次确认之后，三次握手的过程就完成了。</p>
<p>一旦在TCP连接建立之后，就可以在两台计算机之间传输数据。之前提到，所有通过TCP发送的数据包都是可靠的。可靠的工作原理就是在每当数据包通过TCP发送之后，接收者都会告诉发送者我收到数据包。如果发送者在一定时间之内(超时)没有收到应答，就会将数据包再发送一次，发送者会不断地发送数据包，直到收到应答为止。</p>
<p>结果就是TCP不仅保证所有数据包的接收时可按扣的，还会保证它们的顺序。如果发生<strong>数据包丢失</strong>等情况，会大大减慢数据的传输。对于游戏来说，保证顺序很容易成为不必要的瓶颈。</p>
<p>还有一个TCP需要考虑的有用的方面。所有网络都有MTC，或者maximum transmission unit(最大传输单元)，它会决定数据包的大小限制。如果你尝试发送大于MTU的数据包，它会没法通过。幸运的是，TCP在设计上会由操作系统自动将大的数据块分成合适大小的数据包。所以如果你需要从网站上下载1MB的文件，如果使用了TCP，那么分解为合适大小的数据包以及保证接收顺序的事情，程序员就不用操心了。</p>
<p>在大多数场景中，通常不需要在游戏中传输那么大量的数据。但是还是会有用到的情况，比如说，如果游戏支持自定义地图，就会有一个问题，那就是新玩家试图加入游戏会话的时候是没有这张自定义地图的。通过TCP，就可以轻松地将自定义地图发送给试图进入游戏的新玩家，而且不用管地图的大小。</p>
<p>也就是说，对于真正的游戏逻辑来说，只有小部分游戏类型需要用到TCP。对于回合制游戏，使用TCP是有意义的，因为通过网络发送的所有信息都是相关的，它定义了某个回合中玩家执行的动作。另一个常用TCP的游戏类型是MMO，特别是《魔兽世界》，它的所有数据都用TCP传送。</p>
<p>由于TCP是一个相当复杂的协议，TCP数据头跟IP数据头一样大(20字节)。<strong>端口</strong>是一个非常重要的概念。在数据包经过网络发送之后，相同的排序方式也被应用于端口。比如说，大多数Web服务器在80端口接收连接。总共有大约65000个端口可以选择，虽然有的已经被指定使用，但是大多数系统都会有大量的端口空闲着。游戏应该选用一个没有被其他程序使用的端口。。要注意的是，源端口和目标端口不一定是一致的，也就是说，虽然Web服务器连接建立在80端口，但是客户端连接服务器可以使用不同的端口。</p>
<center>
    <img style="border-radius: 0.3125em;
    box-shadow: 0 2px 4px 0 rgba(34,36,38,.12),0 2px 10px 0 rgba(34,36,38,.08);" src="http://pw9tlh9pq.bkt.clouddn.com/3.png">
    <br>
    <div style="color:orange; border-bottom: 1px solid #d9d9d9;
    display: inline-block;
    color: #999;
    font-size: 12px;
    padding: 2px;">图 TCP数据头的结构</div>
</center>

<h2 id="4-UDP"><a href="#4-UDP" class="headerlink" title="4.UDP"></a>4.UDP</h2><p><strong>数据包协议</strong>(UDP)是一种无连接、不可靠的协议，就是说你可以直接发UDP数据包，而不需要与指定目标建立连接。由于它是一个不可靠协议，所以不会有保证数据包到达的手段，也不会保证数据包到达的顺序，也没有接收者应答的功能。由于UDP是一种更加简单的协议，数据头比TCP要小得多。</p>
<p>像TCP一样，UDP也支持大约65000个端口。UDP端口和TCP端口是独立的，所以如果TCP和UDP使用同一个端口是不会冲突的。由于UDP是不可靠的，它的传输比TCP要高效得多。但是由于不知道数据包是否到达，也会造成一些问题。虽然有些数据不太重要，但还是会有一些重要的保证游戏状态一致的数据。如果玩多人FPS游戏，你反射了子弹，这个信息就很重要，要保证它被服务器或者其他玩家所接收。</p>
<center>
    <img style="border-radius: 0.3125em;
    box-shadow: 0 2px 4px 0 rgba(34,36,38,.12),0 2px 10px 0 rgba(34,36,38,.08);" src="http://pw9tlh9pq.bkt.clouddn.com/4.png">
    <br>
    <div style="color:orange; border-bottom: 1px solid #d9d9d9;
    display: inline-block;
    color: #999;
    font-size: 12px;
    padding: 2px;">图 UDP数据头的结构</div>
</center>

<p>一个尝试的解决方案就是将TCP用于关键数据，使用UDP传输不太重要的数据。但是INET 97 proceedings paper指出，在TCP保证系统运行的同时，使用UDP会导致UDP丢包增加。一个更严重的问题是：虽然移动数据不是那么重要，用UDP传送很合理，但我们还是需要数据包的顺序。</p>
<p>大多数游戏处理这个问题都是使用UDP，然后在所需的数据包里增加一些自定义的可靠层来完成。这个额外的层在UDP数据段的开始位置添加——可以认为是自定义的协议数据头。最基本的可靠性数据是<strong>顺序号</strong>，可以跟踪哪个数据包号是哪个，然后通过设置位域莱英达。通过使用位域，某个数据包可以同时应答多个数据包，而不需要每个数据包都应答一次。这个系统同时还有灵活性，就是如果某个系统不需要可靠性和顺序信息，那么可以不添加数据头直接发送。</p>
<p>就行之前所提到的，UDP在实时游戏领域中是占主导地位的协议。几乎所有FPS、动作类、RTS以及其他网络游戏中对时间敏感的信息都会使用UDP。这也是为什么几乎所有为游戏设计的网络中间件(比如RakNet)只支持UDP。</p>
<h1 id="二、网络拓扑"><a href="#二、网络拓扑" class="headerlink" title="二、网络拓扑"></a>二、网络拓扑</h1><p>拓扑决定了不同的计算机在网络游戏会话中是如何相互连接的。虽然配置上有很多种不同的方式，但大多数游戏都支持一种或两种模型：服务器/客户端或是点对点。对于很多情况，两种方法各有优劣。</p>
<h2 id="1-服务器-客户端"><a href="#1-服务器-客户端" class="headerlink" title="1.服务器/客户端"></a>1.服务器/客户端</h2><p>在<strong>服务端/客户端</strong>模型中，有一个中心计算机(也就是<strong>服务器</strong>)，所有的其他计算机(也就是<strong>客户端</strong>)都会与之通信。因为服务器与每一台客户端通信，所以在这个模型中，会需要一台有着比客户端更高带宽和处理能力的机器。比如说，如果客户端发送10Kps数据，在8人游戏中，意味着服务器需要接收80Kps的数据。这类模型通常也叫作中心型结构，因为服务器是所有客户端的中心节点。</p>
<p>服务器/客户端模型是今天最流行的网络游戏拓扑结构。大多数FPS、动作游戏、MMO、策略游戏、回合制游戏等都使用服务器/客户端模型。</p>
<p>在常见的服务器/客户端模型的视线中，服务器会被认为是<strong>权威的</strong>，就是说它需要验证大多数客户端行为。假设网络游戏允许玩家向另一名玩家投掷闪避球，在另一名玩家被闪避球打中之后，投掷的玩家会得分。在权威服务器中，当玩家想投掷闪避球的时候，会先向服务器发起请求，服务器会检查是否是一个合法动作。然后服务器会模拟闪避球的弹道，在每一帧检查这个球是否与某个客户端发生碰撞。如果客户端被击中，服务器会通知客户端被打败。</p>
<p>服务器验证的理由有两个。第一个理由就是服务器会拥有所有客户端的最新位置信息。一个客户端投出闪避球，可能会认为自己投中了，但这可能是因为当时位置不是最新的。而如果客户端能够用闪避球淘汰其他玩家而无须经过服务器验证的话，就很容易有外挂程序作弊淘汰其他玩家。</p>
<p>因为服务器需要认证，服务器/客户端模型的游戏逻辑实现起来就比单人游戏更加复杂。在单人游戏中，如果用空格键发射导弹，相同的代码会检测空格键可以创建和发射导弹。但是在服务器/客户端游戏中，空格键代码必须创建发射请求数据包到服务器，然后服务器通知所有其他玩家导弹的存在。</p>
<p>因为这是两种完全不同的方法，对于想要实现两种模式(多人与单人)的游戏来说，最好的方法就是将单人模式当作特殊的多人模式。这在许多游戏引擎中是默认的实现方式，包括id Software引擎。就是说单人模式实际上是将服务器和客户端都放在一台机器上运行。将单人模式看作多人模式的一种特例的优点在于，只需要一套逻辑代码。否则，网络程序员要在权威服务器的游戏逻辑开发上花很多时间。</p>
<p>我们回到闪避球的例子，相像以下如果玩家可以选择目标。就是说，他们需要用一些方法来知道对手玩家的运动方向才能够预判出成功的投掷。在最好的情况下，客户端可以以四分之一秒一次地收到服务器下发的对手玩家的位置更新数据。现在相像如果客户端只在收到服务器数据的时候才更新对手未知，就是说每隔四份之一秒，对手玩家都会上传新的位置，而对手位置总是闪来闪去，当然听上去游戏似乎不太好玩。</p>
<p>为了解决这个问题，大多数游戏都会实现某种<strong>客户端预测</strong>，也就是客户端会在两次服务器下发数据之间猜测中间的过渡情况。在移动的例子中，如果服务器在下发对手玩家的速度的同时一起下发位置，那么客户端预测就可以工作。然后，在服务器更新的几帧里，客户端可以根据最后收到的速度和位置，推算对手玩家的速度。</p>
<p>只要更新足够频繁，客户端就能让对手玩家在所有时刻都有足够准确的表现。但是，如果由于连接问题导致更新不够频繁，客户端预测就会变得不准确。由于服务器是最权威的存在，客户端必须修复预测位置与真实位置之间的差异。</p>
<p>在任何事件中，为了防止主机带来的问题，许多服务器/客户端游戏只支持<strong>专用服务器</strong>。在大多数例子下，这意味着服务器都是安装在一个特别的位置的(通常在数据中心)，而所有玩家都需要连接到这些服务器(没有玩家可以做主机)。虽然网速快的玩家还是比网速慢的玩家有优势，但是通过这种将服务器放在第三方的方法使得这种优势会大大减弱。可是，运行专用服务器的缺点就是部署得越多，费用就越高。</p>
<h2 id="2-点对点"><a href="#2-点对点" class="headerlink" title="2.点对点"></a>2.点对点</h2><p>在<strong>点对点</strong>模型中，每个客户端都连接到其他客户端。这意味着对于多有客户端都要求同样的性能和带宽。由于点对点模型中没有中心的权威服务器，会有很多种可能：每个客户端只认证自己的动作，或者每个客户端都认证其他客户端，又或者每个客户端都模拟整个世界。</p>
<p>RTS类型中经常会用到点对点模型。正式一点的名称为<strong>帧同步</strong>模型，就是网络更新被分为每次150ms到200ms的回合更新。每当执行一次输入动作，这个命令都会保存到队列里，在每轮结束的时候执行。</p>
<p>因为输入命令通过网络传递，RTS游戏中的每个客户端实际上是在模拟所有单位。它们像本地玩家一样处理输入。这样使得记录下所有对手的指令并在游戏结束后查看即时回放成为可能。</p>
<p>客户端的帧同步方法会使所有客户端都紧密地同步，没有任何玩家能够比其他玩家先走。当然，这种同步方式的缺点就是——如果一个客户端开始延迟，其他客户端都要等待，一直到这个玩家赶上去。但是帧同步方法在RTS游戏里面非常流行，因为它通过网络传输的数据相对来讲会更少。比起发送所有单位的信息，游戏只在每分钟发生相对小数量的动作，即使是最好的RTS玩家每分钟最多也就发送300-400次指令。</p>
<p>因为在点对点配置中，每个点都要模拟游戏世界的一部分，游戏状态必须保证100%的确定。这使得基于变化的游戏逻辑不太好做。</p>
<h1 id="三、作弊"><a href="#三、作弊" class="headerlink" title="三、作弊"></a>三、作弊</h1><p>任何网络游戏主要考虑的一点就是要为玩家打造公平的游戏环境。但不幸的是，有的玩家为了胜利会不择手段，哪怕打破游戏的规则。在网络多人游戏中，有很多规则都有可能会被打破，所以不管是否可能，网络游戏需要防止玩家作弊。</p>
<h2 id="1-信息作弊"><a href="#1-信息作弊" class="headerlink" title="1.信息作弊"></a>1.信息作弊</h2><p><strong>信息作弊</strong>是一种让玩家获得本不该拥有的额外信息的手段。比如FPS游戏中常见的透视挂。</p>
<p>最简单的方法就是通过限制信息来防止信息作弊。但是有的时候这个方案不是那么简单。比如说，在RTS游戏中有一种常见啊的作弊称为图挂。就是让玩家可以看到整张地图，包括所有对手玩家的任何操作。</p>
<p>不幸的是，在图挂的例子中，不能够限制信息的发送，因为这会影响帧同步模型的工作。因为每个点都会模拟整个游戏世界，它必须在所有时间都知道敌人单位的位置，所以这种情况下唯一的方法就是建立反外挂对策。在《星级争霸2》中，暴雪就运行了Warden外挂检测程序，它会在游戏运行的时候，检测是否有其他外挂程序在运行。</p>
<p>这就是外挂制作者和游戏开发公司的一场战争，在任何事件下，开发公平竞技网络游戏的公司都需要对作弊保持高度警惕。</p>
<h2 id="2-游戏状态作弊"><a href="#2-游戏状态作弊" class="headerlink" title="2.游戏状态作弊"></a>2.游戏状态作弊</h2><p>信息作弊能够让玩家获得不对称的优势，而<strong>游戏状态作弊</strong>则可以完全破坏游戏。一旦玩家可以修改游戏状态，玩家很快就能让游戏变得不可玩。常见于游戏作为主机的时候，如果玩家控制了服务器，就很难阻止玩家作弊。</p>
<h2 id="3-中间人攻击"><a href="#3-中间人攻击" class="headerlink" title="3.中间人攻击"></a>3.中间人攻击</h2><p>影响最坏的一种作弊就是在两台通信机器之间设立一台机器，用于拦截所有数据包。这种称为<strong>中间人攻击</strong>，在通过网络发送明文消息的时候特别容易被人篡改。这种攻击是为什么应该使用HTTPS而不是HTTP的主要原因。</p>
<p>使用HTTP，所有数据都以明文的方式通过网络发送。就是说，如果在网站上你用HTTP提交你的用户名和密码，容易遇到中间人窃取信息。而通过HTTPS，所有数据都是加密的，这使得中间人几乎不可能访问到这些信息。</p>
<p>但是，在游戏的情况下，中间人攻击最大的优点在于它允许作弊发生在不需要玩游戏的机器。这就是说几乎所有的外挂检测程序都不起作业——它们根本就不知道数据包被拦截而且被篡改了。还有一个问题就是，一般通过访问数据包信息可能允许黑客更加深入地发掘其他能够渗透游戏的漏洞。</p>
<p>一种防止这类攻击的方法就是对所有数据包进行加密，这样只有服务器才能解密并理解数据包。但这对于大多数游戏消息来说都过重了，对所有信息加密实际上增加了符合。但至少，我们可以在玩家登陆的时候进行一次加密，通过某种加密算法来有效避免玩家账号被盗。</p>
<script>
        document.querySelectorAll('.github-emoji')
          .forEach(el => {
            if (!el.dataset.src) { return; }
            const img = document.createElement('img');
            img.style = 'display:none !important;';
            img.src = el.dataset.src;
            img.addEventListener('error', () => {
              img.remove();
              el.style.color = 'inherit';
              el.style.backgroundImage = 'none';
              el.style.background = 'none';
            });
            img.addEventListener('load', () => {
              img.remove();
            });
            document.body.appendChild(img);
          });
      </script>
            </div>
            <hr/>

            

    <div class="reprint" id="reprint-statement">
        
            <div class="reprint__author">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-user">
                        文章作者:
                    </i>
                </span>
                <span class="reprint-info">
                    <a href="https://oliverbvb.github.io" rel="external nofollow noreferrer">Oliver</a>
                </span>
            </div>
            <div class="reprint__type">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-link">
                        文章链接:
                    </i>
                </span>
                <span class="reprint-info">
                    <a href="https://oliverbvb.github.io/you-xi-bian-cheng-suan-fa-he-ji-qiao-wang-luo-you-xi/">https://oliverbvb.github.io/you-xi-bian-cheng-suan-fa-he-ji-qiao-wang-luo-you-xi/</a>
                </span>
            </div>
            <div class="reprint__notice">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-copyright">
                        版权声明:
                    </i>
                </span>
                <span class="reprint-info">
                    本博客所有文章除特別声明外，均采用
                    <a href="https://creativecommons.org/licenses/by/4.0/deed.zh" rel="external nofollow noreferrer" target="_blank">CC BY 4.0</a>
                    许可协议。转载请注明来源
                    <a href="https://oliverbvb.github.io" target="_blank">Oliver</a>
                    !
                </span>
            </div>
        
    </div>

    <script async defer>
      document.addEventListener("copy", function (e) {
        let toastHTML = '<span>复制成功，请遵循本文的转载规则</span><button class="btn-flat toast-action" onclick="navToReprintStatement()" style="font-size: smaller">查看</a>';
        M.toast({html: toastHTML})
      });

      function navToReprintStatement() {
        $("html, body").animate({scrollTop: $("#reprint-statement").offset().top - 80}, 800);
      }
    </script>



            <div class="tag_share" style="display: block;">
                <div class="post-meta__tag-list" style="display: inline-block;">
                    
                        <div class="article-tag">
                            
                                <a href="/tags/%E6%B8%B8%E6%88%8F%E7%BC%96%E7%A8%8B/">
                                    <span class="chip bg-color">游戏编程</span>
                                </a>
                            
                        </div>
                    
                </div>
                <div class="post_share" style="zoom: 80%; width: fit-content; display: inline-block; float: right; margin: -0.15rem 0;">
                    <link rel="stylesheet" type="text/css" href="/libs/share/css/share.min.css">

<div id="article-share">
    
    
    <div class="social-share" data-sites="twitter,facebook,google,qq,qzone,wechat,weibo,douban,linkedin" data-wechat-qrcode-helper="<p>微信扫一扫即可分享！</p>"></div>
    <script src="/libs/share/js/social-share.min.js"></script>
    

    

</div>

                </div>
            </div>
            
        </div>
    </div>

    

    

    

    

    

    

<article id="prenext-posts" class="prev-next articles">
    <div class="row article-row">
        
        <div class="article col s12 m6" data-aos="fade-up" data-aos="fade-up">
            <div class="article-badge left-badge text-color">
                <i class="far fa-dot-circle"></i>&nbsp;本篇
            </div>
            <div class="card">
                <a href="/you-xi-bian-cheng-suan-fa-he-ji-qiao-wang-luo-you-xi/">
                    <div class="card-image">
                        
                        
                        <img src="/medias/featureimages/16.jpg" class="responsive-img" alt="游戏编程算法和技巧·网络游戏">
                        
                        <span class="card-title">游戏编程算法和技巧·网络游戏</span>
                    </div>
                </a>
                <div class="card-content article-content">
                    <div class="summary block-with-text">
                        
                            一、协议想像寄真实的邮件。我们至少需要一个信封，上面写着这封邮件的寄信地址和手信地址。在信封里面放着的才是你真正需要传递的信息——邮件本身。数据包可以想象成是在网络上传输的电子信封。在它的数据头中有地址和其他相关信息，然后才发出真正的数据帧
                        
                    </div>
                    <div class="publish-info">
                            <span class="publish-date">
                                <i class="far fa-clock fa-fw icon-date"></i>2020-05-08
                            </span>
                        <span class="publish-author">
                            
                            <i class="fas fa-bookmark fa-fw icon-category"></i>
                            
                            <a href="/categories/%E6%B8%B8%E6%88%8F%E7%BC%96%E7%A8%8B/" class="post-category">
                                    游戏编程
                                </a>
                            
                            
                        </span>
                    </div>
                </div>

                
                <div class="card-action article-tags">
                    
                    <a href="/tags/%E6%B8%B8%E6%88%8F%E7%BC%96%E7%A8%8B/">
                        <span class="chip bg-color">游戏编程</span>
                    </a>
                    
                </div>
                
            </div>
        </div>
        
        
        <div class="article col s12 m6" data-aos="fade-up">
            <div class="article-badge right-badge text-color">
                下一篇&nbsp;<i class="fas fa-chevron-right"></i>
            </div>
            <div class="card">
                <a href="/you-xi-bian-cheng-suan-fa-he-ji-qiao-jiao-ben-yu-yan-he-shu-ju-ge-shi/">
                    <div class="card-image">
                        
                        
                        <img src="/medias/featureimages/22.jpg" class="responsive-img" alt="游戏编程算法和技巧·脚本语言和数据格式">
                        
                        <span class="card-title">游戏编程算法和技巧·脚本语言和数据格式</span>
                    </div>
                </a>
                <div class="card-content article-content">
                    <div class="summary block-with-text">
                        
                            一、脚本语言多年前，游戏全部使用汇编语言开发。这是因为早期的机器需要汇编级别的优化才能运行。但是随着计算能力的提升，而游戏又变得很复杂，使用汇编开发就变得越来越没意义了。直到某一天，使用汇编语言开发游戏带来的优点被完全抵消了，这就是为什么现
                        
                    </div>
                    <div class="publish-info">
                            <span class="publish-date">
                                <i class="far fa-clock fa-fw icon-date"></i>2020-05-08
                            </span>
                        <span class="publish-author">
                            
                            <i class="fas fa-bookmark fa-fw icon-category"></i>
                            
                            <a href="/categories/%E6%B8%B8%E6%88%8F%E7%BC%96%E7%A8%8B/" class="post-category">
                                    游戏编程
                                </a>
                            
                            
                        </span>
                    </div>
                </div>
                
                <div class="card-action article-tags">
                    
                    <a href="/tags/%E6%B8%B8%E6%88%8F%E7%BC%96%E7%A8%8B/">
                        <span class="chip bg-color">游戏编程</span>
                    </a>
                    
                </div>
                
            </div>
        </div>
        
    </div>
</article>

</div>



<!-- 代码块功能依赖 -->
<script type="text/javascript" src="/libs/codeBlock/codeBlockFuction.js"></script>

<!-- 代码语言 -->

<script type="text/javascript" src="/libs/codeBlock/codeLang.js"></script>

    
<!-- 代码块复制 -->

<script type="text/javascript" src="/libs/codeBlock/codeCopy.js"></script>


<!-- 代码块收缩 -->

<script type="text/javascript" src="/libs/codeBlock/codeShrink.js"></script>


<!-- 代码块折行 -->

<style type="text/css">
code[class*="language-"], pre[class*="language-"] { white-space: pre !important; }
</style>

    </div>
    <div id="toc-aside" class="expanded col l3 hide-on-med-and-down">
        <div class="toc-widget">
            <div class="toc-title"><i class="far fa-list-alt"></i>&nbsp;&nbsp;目录</div>
            <div id="toc-content"></div>
        </div>
    </div>
</div>

<!-- TOC 悬浮按钮. -->

<div id="floating-toc-btn" class="hide-on-med-and-down">
    <a class="btn-floating btn-large bg-color">
        <i class="fas fa-list-ul"></i>
    </a>
</div>


<script src="/libs/tocbot/tocbot.min.js"></script>
<script>
    $(function () {
        tocbot.init({
            tocSelector: '#toc-content',
            contentSelector: '#articleContent',
            headingsOffset: -($(window).height() * 0.4 - 45),
            collapseDepth: Number('0'),
            headingSelector: 'h1, h2, h3, h4'
        });

        // modify the toc link href to support Chinese.
        let i = 0;
        let tocHeading = 'toc-heading-';
        $('#toc-content a').each(function () {
            $(this).attr('href', '#' + tocHeading + (++i));
        });

        // modify the heading title id to support Chinese.
        i = 0;
        $('#articleContent').children('h1, h2, h3, h4').each(function () {
            $(this).attr('id', tocHeading + (++i));
        });

        // Set scroll toc fixed.
        let tocHeight = parseInt($(window).height() * 0.4 - 64);
        let $tocWidget = $('.toc-widget');
        $(window).scroll(function () {
            let scroll = $(window).scrollTop();
            /* add post toc fixed. */
            if (scroll > tocHeight) {
                $tocWidget.addClass('toc-fixed');
            } else {
                $tocWidget.removeClass('toc-fixed');
            }
        });

        
        /* 修复文章卡片 div 的宽度. */
        let fixPostCardWidth = function (srcId, targetId) {
            let srcDiv = $('#' + srcId);
            if (srcDiv.length === 0) {
                return;
            }

            let w = srcDiv.width();
            if (w >= 450) {
                w = w + 21;
            } else if (w >= 350 && w < 450) {
                w = w + 18;
            } else if (w >= 300 && w < 350) {
                w = w + 16;
            } else {
                w = w + 14;
            }
            $('#' + targetId).width(w);
        };

        // 切换TOC目录展开收缩的相关操作.
        const expandedClass = 'expanded';
        let $tocAside = $('#toc-aside');
        let $mainContent = $('#main-content');
        $('#floating-toc-btn .btn-floating').click(function () {
            if ($tocAside.hasClass(expandedClass)) {
                $tocAside.removeClass(expandedClass).hide();
                $mainContent.removeClass('l9');
            } else {
                $tocAside.addClass(expandedClass).show();
                $mainContent.addClass('l9');
            }
            fixPostCardWidth('artDetail', 'prenext-posts');
        });
        
    });
</script>

    

</main>



    <footer class="page-footer bg-color">
    <div class="container row center-align" style="margin-bottom: 0px !important;">
        <div class="col s12 m8 l8 copy-right">
            Copyright&nbsp;&copy;
            <span id="sitetime"></span>
            <span id="year">2020</span>
            <a href="https://oliverbvb.github.io" target="_blank">Oliver</a>
            |&nbsp;Powered by&nbsp;<a href="https://hexo.io/" target="_blank">Hexo</a>
            |&nbsp;Theme&nbsp;<a href="https://github.com/blinkfox/hexo-theme-matery" target="_blank">Matery</a>
            <br>
            
            &nbsp;<i class="fas fa-chart-area"></i>&nbsp;站点总字数:&nbsp;<span
                class="white-color">70.8k</span>&nbsp;字
            
            
            
            
            
            
            <span id="busuanzi_container_site_pv">
                |&nbsp;<i class="far fa-eye"></i>&nbsp;总访问量:&nbsp;<span id="busuanzi_value_site_pv"
                    class="white-color"></span>&nbsp;次
            </span>
            
            
            <span id="busuanzi_container_site_uv">
                |&nbsp;<i class="fas fa-users"></i>&nbsp;总访问人数:&nbsp;<span id="busuanzi_value_site_uv"
                    class="white-color"></span>&nbsp;人
            </span>
            
            <br>
            
            <br>
            
        </div>
        <div class="col s12 m4 l4 social-link social-statis">
    <a href="https://github.com/oliverbvb" class="tooltipped" target="_blank" data-tooltip="访问我的GitHub" data-position="top" data-delay="50">
        <i class="fab fa-github"></i>
    </a>



    <a href="mailto:tanghaidong1995@gmail.com" class="tooltipped" target="_blank" data-tooltip="邮件联系我" data-position="top" data-delay="50">
        <i class="fas fa-envelope-open"></i>
    </a>







    <a href="tencent://AddContact/?fromId=50&fromSubId=1&subcmd=all&uin=1277509304" class="tooltipped" target="_blank" data-tooltip="QQ联系我: 1277509304" data-position="top" data-delay="50">
        <i class="fab fa-qq"></i>
    </a>







    <a href="/atom.xml" class="tooltipped" target="_blank" data-tooltip="RSS 订阅" data-position="top" data-delay="50">
        <i class="fas fa-rss"></i>
    </a>

</div>
    </div>
</footer>

<div class="progress-bar"></div>

<script language=javascript>
    function siteTime() {
        window.setTimeout("siteTime()", 1000);
        var seconds = 1000;
        var minutes = seconds * 60;
        var hours = minutes * 60;
        var days = hours * 24;
        var years = days * 365;
        var today = new Date();
        var todayYear = today.getFullYear();
        var todayMonth = today.getMonth() + 1;
        var todayDate = today.getDate();
        var todayHour = today.getHours();
        var todayMinute = today.getMinutes();
        var todaySecond = today.getSeconds();
        /* Date.UTC() -- 返回date对象距世界标准时间(UTC)1970年1月1日午夜之间的毫秒数(时间戳)
        year - 作为date对象的年份，为4位年份值
        month - 0-11之间的整数，做为date对象的月份
        day - 1-31之间的整数，做为date对象的天数
        hours - 0(午夜24点)-23之间的整数，做为date对象的小时数
        minutes - 0-59之间的整数，做为date对象的分钟数
        seconds - 0-59之间的整数，做为date对象的秒数
        microseconds - 0-999之间的整数，做为date对象的毫秒数 */
        var t1 = Date.UTC(2017, 09, 11, 00, 00, 00); //北京时间2018-2-13 00:00:00
        var t2 = Date.UTC(todayYear, todayMonth, todayDate, todayHour, todayMinute, todaySecond);
        var diff = t2 - t1;
        var diffYears = Math.floor(diff / years);
        var diffDays = Math.floor((diff / days) - diffYears * 365);
        var diffHours = Math.floor((diff - (diffYears * 365 + diffDays) * days) / hours);
        var diffMinutes = Math.floor((diff - (diffYears * 365 + diffDays) * days - diffHours * hours) / minutes);
        var diffSeconds = Math.floor((diff - (diffYears * 365 + diffDays) * days - diffHours * hours - diffMinutes * minutes) / seconds);
        document.getElementById("sitetime").innerHTML = "本站已运行 " +diffYears+" 年 "+diffDays + " 天 " + diffHours + " 小时 " + diffMinutes + " 分钟 " + diffSeconds + " 秒";
    }/*因为建站时间还没有一年，就将之注释掉了。需要的可以取消*/
    siteTime();
</script>

    <!-- 搜索遮罩框 -->
<div id="searchModal" class="modal">
    <div class="modal-content">
        <div class="search-header">
            <span class="title"><i class="fas fa-search"></i>&nbsp;&nbsp;搜索</span>
            <input type="search" id="searchInput" name="s" placeholder="请输入搜索的关键字"
                   class="search-input">
        </div>
        <div id="searchResult"></div>
    </div>
</div>

<script src="/js/search.js"></script>
<script type="text/javascript">
$(function () {
    searchFunc("/" + "search.xml", 'searchInput', 'searchResult');
});
</script>
    <!-- 回到顶部按钮 -->
<div id="backTop" class="top-scroll">
    <a class="btn-floating btn-large waves-effect waves-light" href="#!">
        <i class="fas fa-arrow-up"></i>
    </a>
</div>


    <script src="/libs/materialize/materialize.min.js"></script>
    <script src="/libs/masonry/masonry.pkgd.min.js"></script>
    <script src="/libs/aos/aos.js"></script>
    <script src="/libs/scrollprogress/scrollProgress.min.js"></script>
    <script src="/libs/lightGallery/js/lightgallery-all.min.js"></script>
    <script src="/js/matery.js"></script>

    <!-- Global site tag (gtag.js) - Google Analytics -->


    <!-- Baidu Analytics -->

    <!-- Baidu Push -->

<script>
    (function () {
        var bp = document.createElement('script');
        var curProtocol = window.location.protocol.split(':')[0];
        if (curProtocol === 'https') {
            bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
        } else {
            bp.src = 'http://push.zhanzhang.baidu.com/push.js';
        }
        var s = document.getElementsByTagName("script")[0];
        s.parentNode.insertBefore(bp, s);
    })();
</script>

    
    <script src="/libs/others/clicklove.js" async="async"></script>
    
    
    <script async src="/libs/others/busuanzi.pure.mini.js"></script>
    

    

    

    

    

    
    
    
    <script src="/libs/instantpage/instantpage.js" type="module"></script>
    

<script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/","tagMode":false,"log":false,"model":{"jsonPath":"/live2dw/assets/shizuku.model.json"},"display":{"position":"right","width":150,"height":300},"mobile":{"show":true},"react":{"opacity":0.7}});</script></body>

</html>
